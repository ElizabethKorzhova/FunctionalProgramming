(define (p/r) ; визначаємо функцію для читання з консолі
  (string->number (read-line))) ; читаємо з консолі, кастимо до числа та повертаємо

(define (log10 n) (/ (log n) (log 10))) ; визначаємо функцію для пошуку десяткового логарифму

(define (number-length n) ; визначаємо функцію для пошуку довжини числа
    (+ 1 (floor->exact (log10 n)))) ; шукаємо довжину числа за формулою 1 + [log10(n)]

(define (last-digit n) ; визначаємо функцію для пошуку останньої цифри в числі
    (modulo n 10)) ; остання цифра числа - остача від ділення на 10

(define (first-digit n) ; визначаємо функцію для пошуку першої цифри в числі
    (if (< n 10) ; якщо число меньше за 10
        n ; вертаємо саме число
        (first-digit (quotient n 10)) ; інакше, рекурсивно ділимо націло на 10, допоки не отримаємо число менше 10
    )
)

(define (sum-of-digits n) ; визначаємо функцію для пошуку суми цифр в числі
    (define (sum-of-digits-times acc n) ; визначаємо допоміжну функцію для хвостової рекурсії. асс - акумулятор, тобто сума цифр. n - поточне число
        (if (< n 10) ; якщо числе менше за 10
            (+ acc n) ; то це була перша цифра, плюсуємо до попередньої суми та повертаємо
            (sum-of-digits-times
                                 (+ acc (modulo n 10)) ; новий акумулятор - сума старого акумулятора та останньої цифри в числі
                                 (quotient n 10) ; наступне число - поточне поділене націло на 10
            )
        )
    )
    (sum-of-digits-times 0 n) ; викликаємо рекурсивну функцію з початковими значеннями параметрів
)

(define (main-function n) ; визначаємо головну функцію програми
    (begin ; початок многострокового коду
        (display "Number length: ") ; виводимо повідомлення, що далі буде виведена довжина числа
        (display (number-length n)) ; виводимо довжину числа
        (newline) ; переходимо на нову лінію
        (display "Number first digit: ") ; виводимо повідомлення, що далі буде виведена перша цифра числа
        (display (first-digit n)) ; виводимо першу цифру числа
        (newline) ; переходимо на нову лінію
        (display "Number last digit: ") ; виводимо повідомлення, що далі буде виведена остання цифра числа
        (display (last-digit n)) ; виводимо останню цифру числа
        (newline) ; переходимо на нову лінію
        (display "Sum of digits: ") ; виводимо повідомлення, що далі буде виведена сума цифр числа
        (display (sum-of-digits n)) ; виводимо суму цифр числа
    )
)

(main-function (p/r)) ; читаємо число з консолі та викликаємо головну функцію
